(function(e){e.BubbleShoot={MODES:{SINGLEPLAYER:'singleplayer'},deploy:'produccion',PLAYER_SIDE_TOP:'top',PLAYER_SIDE_BOTTOM:'bottom',BUBBLE_STATE_ON_BOARD:1,BUBBLE_STATE_FIRING:3,BUBBLE_STATE_POPPING:4,points:0,debug:!1,newline:0,Service:{}}})(this.window||this),function(e){function t(g,u){return 0==u?g:t(u,g%u)}var o=screen.width,r=screen.height,l=t(o,r);e.aspectRatio=[o/l,r/l]}(BubbleShoot),function(e){var p=function(){function w(I,U){return I+U}return function(I){return I.reduce(w,0)/I.length}}(),m=function(){var w=function(T){var A=0,P=0;for(P in T)T.hasOwnProperty(P)&&A++;return A},I=function(T,A){var P=0,E=0;for(E in T)if(T.hasOwnProperty(E)){if(P==A)return E;P++}return!1},U=function(T,A,P){return P=null===P?1:P,T=S(T)?1*T:T.toLowerCase(),A=S(A)?1*A:A.toLowerCase(),T==A?0:T>A?1*P:-1*P},S=function(T){return!isNaN(parseFloat(T))&&isFinite(T)};return function(B,T){T=T||{};var A=w(T);if(!A)return B.sort(U);for(var P in T)T[P]='desc'==T[P]||-1==T[P]?-1:'skip'==T[P]||0===T[P]?0:1;return B.sort(function(E,O){for(var L,_=0,G=0;0===_&&G<A;)if(L=I(T,G),L){var R=T[L];_=U(E[L],O[L],R),G++}return _}),B}}(),h=function(){var w=[{base:'A',letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:'AA',letters:/[\uA732]/g},{base:'AE',letters:/[\u00C6\u01FC\u01E2]/g},{base:'AO',letters:/[\uA734]/g},{base:'AU',letters:/[\uA736]/g},{base:'AV',letters:/[\uA738\uA73A]/g},{base:'AY',letters:/[\uA73C]/g},{base:'B',letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:'C',letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:'D',letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:'DZ',letters:/[\u01F1\u01C4]/g},{base:'Dz',letters:/[\u01F2\u01C5]/g},{base:'E',letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:'F',letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:'G',letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:'H',letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:'I',letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:'J',letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:'K',letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:'L',letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:'LJ',letters:/[\u01C7]/g},{base:'Lj',letters:/[\u01C8]/g},{base:'M',letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:'N',letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:'NJ',letters:/[\u01CA]/g},{base:'Nj',letters:/[\u01CB]/g},{base:'O',letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:'OI',letters:/[\u01A2]/g},{base:'OO',letters:/[\uA74E]/g},{base:'OU',letters:/[\u0222]/g},{base:'P',letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:'Q',letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:'R',letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:'S',letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:'T',letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:'TZ',letters:/[\uA728]/g},{base:'U',letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:'V',letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:'VY',letters:/[\uA760]/g},{base:'W',letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:'X',letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:'Y',letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:'Z',letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:'a',letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:'aa',letters:/[\uA733]/g},{base:'ae',letters:/[\u00E6\u01FD\u01E3]/g},{base:'ao',letters:/[\uA735]/g},{base:'au',letters:/[\uA737]/g},{base:'av',letters:/[\uA739\uA73B]/g},{base:'ay',letters:/[\uA73D]/g},{base:'b',letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:'c',letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:'d',letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:'dz',letters:/[\u01F3\u01C6]/g},{base:'e',letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:'f',letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:'g',letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:'h',letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:'hv',letters:/[\u0195]/g},{base:'i',letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:'j',letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:'k',letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:'l',letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:'lj',letters:/[\u01C9]/g},{base:'m',letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:'n',letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:'nj',letters:/[\u01CC]/g},{base:'o',letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:'oi',letters:/[\u01A3]/g},{base:'ou',letters:/[\u0223]/g},{base:'oo',letters:/[\uA74F]/g},{base:'p',letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:'q',letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:'r',letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:'s',letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:'t',letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:'tz',letters:/[\uA729]/g},{base:'u',letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:'v',letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:'vy',letters:/[\uA761]/g},{base:'w',letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:'x',letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:'y',letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:'z',letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];return function(I){for(var U=0;U<w.length;U++)I=I.replace(w[U].letters,w[U].base);return I}}();e.Utils={mean:p,createRect:function(w,I,U){var S=BubbleShoot.game.add.bitmapData(w,I);return S.ctx.beginPath(),S.ctx.rect(0,0,w,I),S.ctx.fillStyle=U,S.ctx.fill(),S.ctx.closePath(),S},createButton:function(){},getRandomInt:function(w,I){return Math.floor(Math.random()*(I-w+1))+w},generateUUID:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},radiansToDegrees:function(w){return 180*w/Math.PI},degreesToRadians:function(w){return w*Math.PI/180},keySort:m,removeAccents:h}}(this.window||this),function(e){function t(o){this.queue={},Worker?this.worker=new Worker('src/js/ai/service.'+o+'.js'):alert('Error: Worker not suported!');var r=this;this.worker.addEventListener('message',function(l){var g=l.data,u=r.queue[g.id];r.queue[g.id]&&(r.queue[g.id].done.apply(u.context,g.args),delete r.queue[g.id])})}t.prototype.execute=function(o,r,l,g){var u=Utils.generateUUID();l&&(this.queue[u]={done:l,context:g||null}),this.worker.postMessage({id:u,command:o,args:r})},e.Background=t}(BubbleShoot);(function(e){var t=0,o=0,r=0,l={},g=0,u=0,p=function(h){this.player=h,this.side=h.side,this.x=0,this.y=0,this.grid=[],this.maxRows=0,this.maxCols=0};p.prototype={setGrid:function(h){this.grid=h,this.maxRows=this.grid.length,this.maxCols=this.grid[0].length},createGrid:function(h,w){this.maxRows=h,this.maxCols=w,this.grid=[],o=0;for(var I=0;I<this.maxRows;I++){this.grid[I]=[];for(var U=0==I%2,S=0;S<this.maxCols;S++)(U||!(S>=this.maxCols-1))&&(this.grid[I][S]=BubbleShoot.Bubble.getRandomSprite())}},createLifes:function(){this.lifes=BubbleShoot.game.add.group();var h=BubbleShoot.game.add.image(0,0,'bolaon'),w=BubbleShoot.game.add.image(0,0,'bolaon'),I=BubbleShoot.game.add.image(0,0,'bolaon');h.y=0.95*BubbleShoot.game.world.height-0.95*h.height,h.x=BubbleShoot.game.world.width/2-h.width/2+-220,w.y=0.95*BubbleShoot.game.world.height-0.95*w.height,w.x=BubbleShoot.game.world.width/2-w.width/2+-175,I.y=0.95*BubbleShoot.game.world.height-0.95*I.height,I.x=BubbleShoot.game.world.width/2-I.width/2+-130,this.lifes.add(h),this.lifes.add(w),this.lifes.add(I)},createBubbles:function(){BubbleShoot.UI.board.separatorHeight+1;this.height=95,this.width=BubbleShoot.UI.bubble.size*this.maxCols,this.x=BubbleShoot.UI.board.width-this.width,this.side==BubbleShoot.PLAYER_SIDE_BOTTOM&&(this.y=this.height),this.side==BubbleShoot.PLAYER_SIDE_TOP&&(this.y=0);for(var w=0,I=this.grid.length;w<I;w++)for(var U=0,S=this.grid[w].length;U<S;U++){var B=this.grid[w][U],T=BubbleShoot.Bubble.create(this.player,w,U,B);T.fixPositionByGrid(),this.grid[w][U]=T}},createLine:function(){r=0,this.gridNew=[],o++;var h=0==o%2;if(h)var w=9;else var w=8;for(var I=0;I<w;I++)this.gridNew.push(BubbleShoot.Bubble.getRandomSprite());for(var I=0;I<w;I++){var U=this.gridNew[I],S=BubbleShoot.Bubble.create(this.player,0,I,U);S.alpha=0;BubbleShoot.game.add.tween(S).to({alpha:1},200,'Linear',!0,0);this.gridNew[I]=S}this.grid.unshift(this.gridNew);for(var T=0,A=this.grid.length;T<A;T++)for(var S,I=0,P=this.grid[T].length;I<P;I++)S=this.grid[T][I],void 0!=S&&(S.row=T,S.col=I,S.fixPositionByGrid())},addBubble:function(h){this.grid[h.row]||(this.grid[h.row]=[]),this.grid[h.row][h.col]&&console.error('addBubble rewrite grid',h.row,h.col),this.grid[h.row][h.col]=h},removeBubble:function(h,w){if(delete this.grid[h.row][h.col],!w)return h.kill();if('remove'==w){h.children[0].visible=!0;var I=h.children[0].animations.add('chispa');h.children[0].animations.play('chispa',30,!1),I.onComplete.add(function(){h.children[0].animations.stop(),h.children[0].kill(),h.loadTexture('plop'+h.points);var S=BubbleShoot.game.add.tween(h.scale).to({x:BubbleShoot.UI.bubble.scale+0.1,y:BubbleShoot.UI.bubble.scale+0.1},200,'Linear',!0,0);S.onComplete.add(function(){setTimeout(function(){var B=BubbleShoot.game.add.tween(h.scale).to({x:0,y:0},400,'Linear',!0,0);B.onComplete.add(function(){h.kill(),h.loadTexture('sprites',h.tag)})},200)})})}else{h.children[0].visible=!0;var U=h.children[0].animations.add('chispa');h.children[0].animations.play('chispa',30,!1),U.onComplete.add(function(){h.children[0].animations.stop(),h.children[0].kill(),setTimeout(function(){var S=BubbleShoot.game.add.tween(h.scale).to({x:0,y:0},400,'Linear',!0,0);S.onComplete.add(function(){h.kill()})},200)})}},getBubbleAt:function(h,w){return this.grid[h]&&this.grid[h][w]&&this.grid[h][w]},getBubblesAround:function(h,w){for(var I=[],U=0==h%2,S=h-1;S<=h+1;S++)for(var B=w-1;B<=w+1;B++)if((B!=w||S!=h)&&(U||S==h||B!==w-1)&&!(U&&S!=h&&B===w+1)){var T=this.getBubbleAt(S,B);T&&I.push(T)}return I},getGroup:function(h,w,I){var w=w||{},U=h.row,S=h.col;if(w[U]||(w[U]={}),w.list||(w.list=[]),w[U][S])return w;w[U][S]=h,w.list.push(h);for(var A,B=this.getBubblesAround(U,S),T=0;T<B.length;T++)A=B[T],(A.tag==h.tag||I)&&(w=this.getGroup(A,w,I));return w},findOrphans:function(){for(var h=[],I=[],U=0;U<this.grid.length;U++)h[U]=[];for(var B,S=0;S<this.grid[0].length;S++)if(B=this.getBubbleAt(0,S),B&&!h[0][S]){var T=this.getGroup(B,{},!0);T.list.forEach(function(A){h[A.row][A.col]=!0})}for(var U=0;U<this.grid.length;U++)for(var B,S=0;S<this.grid[U].length;S++)B=this.getBubbleAt(U,S),B&&!h[U][S]&&I.push(B);return I},addBubblex:function(h,w){var I=this,U=w.some(function(S){return S===h});U||(console.log(U),'magenta'==h.tag&&g++,'blue'==h.tag&&u++,w.push(h))},searchMagentaBlue:function(h){var w=this,I=!0,U=h.tag,S='';g=0,u=0,'magenta'==h.tag?(g++,S='blue'):(u++,S='magenta'),h.tag='blue';var B=this.getGroup(h);h.tag='magenta';var T=this.getGroup(h);if(h.tag=U,'magenta'==h.tag||'blue'==h.tag){if(3<=B.list.length)if(l.list=[],B.list.forEach(function(P){P.tag;P.tag=S;var O=w.getGroup(P);P.tag='blue';var _=O.list;2<=_.length&&_.forEach(function(G){w.addBubblex(G,l.list)})}),0!=g&&0!=u){BubbleShoot.animations.purpleX2.visible=!0;var A=BubbleShoot.animations.purpleX2.animations.add('explode');BubbleShoot.animations.purpleX2.animations.play('explode',30,!1),A.onComplete.add(function(){BubbleShoot.animations.purpleX2.visible=!1}),r=0,BubbleShoot.sound.explosion.play(),BubbleShoot.sound.goodjob.play(),console.log(l),I=!1,r=0,B.list.forEach(function(P){w.addBubblex(P,l.list)}),l.list.forEach(function(P){('magenta'==P.tag||'blue'==P.tag)&&(t+=40,P.points=40),w.removeBubble(P,'remove')})}else I=!0;if(console.log('Roll   '+g+'  -  '+u),g=0,u=0,3<=T.list.length)if(l.list=[],T.list.forEach(function(P){var E=P.tag;P.tag='magenta';var O=w.getGroup(P);P.tag=E;var _=O.list;2<=_.length&&_.forEach(function(G){w.addBubblex(G,l.list)})}),0!=g&&0!=u){BubbleShoot.animations.purpleX2.visible=!0;var A=BubbleShoot.animations.purpleX2.animations.add('explode');BubbleShoot.animations.purpleX2.animations.play('explode',30,!1),A.onComplete.add(function(){BubbleShoot.animations.purpleX2.visible=!1}),console.log(l),r=0,BubbleShoot.sound.explosion.play(),BubbleShoot.sound.goodjob.play(),I=!1,r=0,T.list.forEach(function(P){w.addBubblex(P,l.list)}),l.list.forEach(function(P){('magenta'==P.tag||'blue'==P.tag)&&(t+=40,P.points=40),w.removeBubble(P,'remove')})}else I=!0;return console.log('Back   '+g+'  -  '+u),!1!=I}return!0},checkMatches:function(h){var w=this.getGroup(h),I=this;r++;var U=this.searchMagentaBlue(h);if(console.log(U),U||void 0==U)if(3>w.list.length);else{if(BubbleShoot.sound.explosion.play(),r=0,'magenta'==w.list[0].tag){BubbleShoot.animations.sabor.visible=!0;var S=BubbleShoot.animations.sabor.animations.add('explode');BubbleShoot.animations.sabor.animations.play('explode',30,!1),S.onComplete.add(function(){BubbleShoot.animations.sabor.visible=!1})}else if('blue'==w.list[0].tag){BubbleShoot.animations.mentol.visible=!0;var S=BubbleShoot.animations.mentol.animations.add('explode');BubbleShoot.animations.mentol.animations.play('explode',30,!1),S.onComplete.add(function(){BubbleShoot.animations.mentol.visible=!1})}w.list.forEach(function(B){t+='magenta'==B.tag||'blue'==B.tag?20:10,I.removeBubble(B,'remove')})}3<=r&&(BubbleShoot.player.board.createLine(),BubbleShoot.player.board.createLine()),this.updatelifes(r),console.log(r)},updatelifes:function(h){console.log(this.lifes),0==h?this.lifes.children.forEach(function(w){w.loadTexture('bolaon')}):1==h?this.lifes.children.forEach(function(w,I){console.log(I),0==I||1==I?w.loadTexture('bolaon'):w.loadTexture('bolaoff')}):2==h&&this.lifes.children.forEach(function(w,I){0==I?w.loadTexture('bolaon'):w.loadTexture('bolaoff')})},checkOrphans:function(){var h=this;this.findOrphans().forEach(function(w){h.removeBubble(w,'removeOnly')})},getRemaining:function(){for(var h=[],w=0;w<this.grid.length;w++)for(var U,I=0;I<this.grid[w].length;I++)U=this.getBubbleAt(w,I),U&&h.push(U);return h},getNextBubbleTag:function(h){var I=[],h=h||this.getRemaining();return h.forEach(function(U){-1===I.indexOf(U.tag)&&I.push(U.tag)}),2>=I.length?I[Utils.getRandomInt(0,I.length-1)]:void BubbleShoot.Bubble.getRandomSprite()},getGridMetaData:function(){for(var h=[],w=0;w<this.grid.length;w++){h[w]=[];for(var U,I=0;I<this.grid[w].length;I++)U=this.getBubbleAt(w,I),h[w][I]=U?U.getMetaData():U}return h},getMetaData:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,side:this.side,grid:this.getGridMetaData()}},returnPoints:function(){return t},secondsToTime:function(h){function w(T){return(10>T?'0':'')+T}var I=h%1e3;h=(h-I)/1e3;var U=h%60;h=(h-U)/60;var S=h%60,B=(h-S)/60;return w(B)+':'+w(S)+':'+w(U)+'.'+w(I)},savePoints:function(h){if('produccion'==BubbleShoot.deploy){var w=t,I=this.secondsToTime(h);if(console.log(t+' - '+BubbleShoot.UI.infoUsuarioAPI.pointsOld),t>BubbleShoot.UI.infoUsuarioAPI.pointsOld){console.log('SEND POINTS');var S=new XMLHttpRequest;if(1==BubbleShoot.UI.reg)var B='https://ddbdev.co/chesterbubbleAPI/public/ranking/'+BubbleShoot.UI.infoUsuarioAPI.idAPI;else var B='https://ddbdev.co/chesterbubbleAPI2/public/ranking/'+BubbleShoot.UI.infoUsuarioAPI.idAPI;S.open('PUT',B,!0),S.setRequestHeader('Content-type','application/x-www-form-urlencoded'),S.onreadystatechange=function(){200==S.status&&4==S.readyState&&(console.log(S.responseText),BubbleShoot.UI.infoUsuarioAPI.pointsOld=w)};try{return S.send('points='+w+'&time='+I),t=0,r=0,!0}catch(T){return console.log(T),!1}}}else{return t=0,r=0,!0}}},e.Board=p})(BubbleShoot),function(e){function t(r,l,g,u){Phaser.Sprite.call(this,BubbleShoot.game,0,0,'sprites',u||t.getRandomSprite()),BubbleShoot.entities.bubbles.add(this),this.player=r,this.tag=this.frameName,this.scale.setTo(BubbleShoot.UI.bubble.scale),this.anchor.setTo(0.5),this.row=l,this.col=g,this.radius=BubbleShoot.UI.bubble.radius;var p=BubbleShoot.game.make.sprite(-250,-250,'chispa-'+this.frameName);p.visible=!1,this.addChild(p)}var o=['green','blue','yellow','red','magenta','orange'];t.prototype=Object.create(Phaser.Sprite.prototype),t.prototype.constructor=t,t.prototype.getGridByPosition=function(r){var l=this.player.side==BubbleShoot.PLAYER_SIDE_TOP,g=this.player.board,r=r||this.position,u=BubbleShoot.UI.board.separatorHeight+1,p=Math.floor((r.y-g.y)/BubbleShoot.UI.board.rowHeight);if(l)var p=Math.floor((g.height-r.y)/BubbleShoot.UI.board.rowHeight);var m=0==p%2?BubbleShoot.UI.bubble.radius:2*BubbleShoot.UI.bubble.radius,h=(r.x-g.x+m)/BubbleShoot.UI.bubble.size;return h=Math.round(h),h>BubbleShoot.UI.maxCols&&(h=BubbleShoot.UI.maxCols),1==p%2&&(h-=2),0==p%2&&(h-=1),{row:p,col:h}},t.prototype.fixGridByPosition=function(r){var l=this.getGridByPosition(r);this.row=l.row,this.col=l.col},t.prototype.savelength=function(r){this.length=r},t.prototype.getPositionByGrid=function(r){var r=r||{row:this.row,col:this.col};if(void 0===r.row||void 0===r.col)return console.error('getPositionByGrid',r.row,r.col),!1;var l=this.player.side==BubbleShoot.PLAYER_SIDE_TOP,g=BubbleShoot.UI.board.separatorHeight+1,u=this.player.board.x,p=this.player.board.height+BubbleShoot.UI.bubble.radius;return u+=0==r.row%2?BubbleShoot.UI.bubble.radius:2*BubbleShoot.UI.bubble.radius,l?p-=(r.row+1)*BubbleShoot.UI.board.rowHeight+g:p+=r.row*BubbleShoot.UI.board.rowHeight+1.5*g,{x:u+r.col*BubbleShoot.UI.bubble.size,y:p}},t.prototype.fixPositionByGrid=function(r){var l=this.getPositionByGrid(r);this.position.setTo(l.x,l.y),this.createDebugText()},t.prototype.move=function(r,l,g){if(BubbleShoot.fire=!0,console.log('Fire'),BubbleShoot.sound.shoot.play(),!1===Array.isArray(r))return console.error('invalid parameters, expected Array of steps');this.state=BubbleShoot.BUBBLE_STATE_FIRING;var g=void 0==g||g,u=BubbleShoot.game.add.tween(this);if(r.forEach(function(m){u.to({x:m.position.x,y:m.position.y},m.duration)}),g){var p=r.pop().position;this.fixGridByPosition(p),this.player.board.addBubble(this),this._endPosition=this.getPositionByGrid()}u.onComplete.add(function(){g&&(this.state=BubbleShoot.BUBBLE_STATE_ON_BOARD,this.fixPositionByGrid(),delete this._endPosition),l&&l(this)}.bind(this)),u.start()},t.prototype.getMetaData=function(){return{tag:this.tag,radius:this.radius,row:this.row,col:this.col,x:this.x,y:this.y,position:{x:this.x,y:this.y},_endPosition:this._endPosition,state:this.state}},t.prototype.createDebugText=function(){if(this.points='magenta'==this.tag||'blue'==this.tag?20:10,!BubbleShoot.debug)return!1;if(!this.debugText){var l=BubbleShoot.game.add.text(0,0,'',{font:'50px Arial',fill:'#ffffff'});l.anchor.setTo(0.5),this.addChild(l),this.debugText=l}return void 0==this.row||void 0==this.col?this.debugText.setText(''):void this.debugText.setText(this.row+' - '+(this.col+''))},t.RADIUS=177/2,t.SIZE=2*t.RADIUS,t.create=function(r,l,g,u){var p,u=u;return p&&(p.revive(),p.row=l,p.col=g,p.frameName=u,p.tag=u,p.player=r),p||(p=new t(r,l,g,u)),p.createDebugText(),p},t.getRandomSprite=function(){return o[Utils.getRandomInt(0,o.length-1)]},e.Bubble=t}(BubbleShoot);(function(e){var t=function(r){Phaser.Sprite.call(this,BubbleShoot.game,BubbleShoot.game.world.centerX,0),BubbleShoot.entities.add(this),r.shooter=this,this.player=r,this._loaded=!1,this._loading=!1,this._nextLoaded=[],this.BitmapSprite={},this.scale.setTo(0.3),this.anchor.setTo(0.5,0.75),r.side==BubbleShoot.PLAYER_SIDE_TOP&&(this.angle=179,this.y=this.height/4),r.side==BubbleShoot.PLAYER_SIDE_BOTTOM&&(this.angle=0,this.y=BubbleShoot.game.height-200)};t.prototype=Object.create(Phaser.Sprite.prototype),t.prototype.constructor=t,t.prototype.fire=function(o,r){var l=this.bubble;if(!l||!this._loaded)return!1;var r=r||BubbleShoot.Collision.trajectory(this.position,this.rotation,this.player.board);l.move(r,o),this.bubble=null},t.prototype.changeBubble=function(){if(console.log(this._nextLoaded),this._nextLoaded.length){var o=BubbleShoot.player.shooter.bubble.tag;BubbleShoot.player.shooter.bubble.tag=this._nextLoaded.shift(),BubbleShoot.player.shooter.bubble.loadTexture('sprites',BubbleShoot.player.shooter.bubble.tag),this._nextLoaded.push(o),console.log(o),this.changeAlterBubble(o)}else{BubbleShoot.player.shooter._nextLoaded.push(BubbleShoot.Bubble.getRandomSprite());var o=BubbleShoot.player.shooter.bubble.tag;BubbleShoot.player.shooter.bubble.tag=this._nextLoaded.shift(),BubbleShoot.player.shooter.bubble.loadTexture('sprites',BubbleShoot.player.shooter.bubble.tag),this._nextLoaded.push(o),console.log(o),this.changeAlterBubble(o)}},t.prototype.changeAlterBubble=function(o){BubbleShoot.alterBubble.loadTexture('sprites',o),BubbleShoot.alterBubble.tag=o},t.prototype.createAlterBubble=function(){this._nextLoaded.length?(BubbleShoot.alterBubble=BubbleShoot.Bubble.create(this.player,void 0,void 0,this._nextLoaded[0]),BubbleShoot.alterBubble.scale.setTo(0.3),BubbleShoot.alterBubble.position.set(BubbleShoot.game.world.centerX-70,BubbleShoot.game.height-150)):(BubbleShoot.player.shooter._nextLoaded.push(BubbleShoot.Bubble.getRandomSprite()),BubbleShoot.alterBubble=BubbleShoot.Bubble.create(this.player,void 0,void 0,BubbleShoot.player.shooter._nextLoaded[0]),BubbleShoot.alterBubble.scale.setTo(0.3),BubbleShoot.alterBubble.position.set(BubbleShoot.game.world.centerX-70,BubbleShoot.game.height-150))},t.prototype.getBitmapData=function(){return this.bmd||(this.bmd=BubbleShoot.game.add.bitmapData(this.player.board.width,BubbleShoot.UI.height),this.BitmapSprite=BubbleShoot.game.add.sprite(this.player.board.x,this.player.board.y,this.bmd),BubbleShoot.entities.add(this.BitmapSprite)),this.bmd},t.prototype.showTrajectory=function(o){var r=BubbleShoot.Collision.trajectory(this.position,this.rotation,this.player.board);this.BitmapSprite.visible=!!o;var l=this.getBitmapData(),g=l.context,u=this.player.board;l.clear(),g.beginPath(),g.strokeStyle='white',g.lineWidth=10,g.setLineDash([15]),g.moveTo(this.position.x-u.x,this.position.y-u.y),r.forEach(function(p){g.lineTo(p.position.x-u.x,p.position.y-u.y)}.bind(this)),g.stroke(),g.strokeStyle='rgb(168, 133, 264',g.lineWidth=6,g.stroke(),g.lineWidth=3,g.strokeStyle='rgb(72, 204, 254)',g.globalAlpha=0.5,g.stroke()},t.prototype.showTrajectoryNew=function(){var o=BubbleShoot.game.make.sprite(0,0,'plop40'),r=this.player.board,l=BubbleShoot.Collision.trajectory(this.position,this.rotation,this.player.board),g=this.getBitmapData(),u=g.context;g.smoothed=!1,l.forEach(function(){g.draw(0,100)}.bind(this)),u.stroke()},t.prototype.reload=function(o){if(this.bubble||this._loading)return!1;this._loading=!0,this._loaded=!1;var l=BubbleShoot.Bubble.create(this.player,void 0,void 0,this._nextLoaded.shift());l.anchor.setTo(0.5),l.position.set(this.x,this.y);var g=function(){this.bubble=l,this._loading=!1,this._loaded=!0};if(o)return g.call(this);var u=BubbleShoot.UI.bubble.scale;l.scale.setTo(1e-3);var p=BubbleShoot.game.add.tween(l.scale);return p.to({x:u,y:u},333),p.onComplete.add(g.bind(this)),p.start(),!0},t.prototype.setRotation=function(o){this.rotation=o,this.player.side==BubbleShoot.PLAYER_SIDE_BOTTOM&&55<Math.abs(this.angle)&&(this.angle=0<this.angle?55:-55),this.player.side==BubbleShoot.PLAYER_SIDE_TOP&&50>Math.abs(this.angle)&&(this.angle=0<this.angle?55:-55)},t.prototype.getMetaData=function(){return{x:this.x,y:this.y,position:{x:this.x,y:this.y},rotation:this.rotation}},e.Shooter=t})(BubbleShoot);(function(e){function t(o,r){this.id=o,this.side=r,this.shooter=new BubbleShoot.Shooter(this),this.board=new BubbleShoot.Board(this)}t.prototype={getMetaData:function(){return{id:this.id,side:this.side,shooter:this.shooter.getMetaData(),board:this.board.getMetaData()}},fire:function(r,l){12<BubbleShoot.player.board.grid.length&&BubbleShoot.player.board.grid[12].map(function(g){g!=void 0&&(lose=!0)});this.shooter.fire(function(u){var m=!1;if((this.side==BubbleShoot.PLAYER_SIDE_BOTTOM&&u.y+u.radius>this.shooter.y-this.shooter.height/2||this.side==BubbleShoot.PLAYER_SIDE_TOP&&u.y-u.radius<this.shooter.y+this.shooter.height/2)&&(m=!0),!m){this.board.checkMatches(u),this.board.checkOrphans();var h=this.board.getRemaining();if(console.log('Choca'),setTimeout(function(){BubbleShoot.textPuntos.text=BubbleShoot.player.board.returnPoints(),BubbleShoot.textPuntos.updateText(),BubbleShoot.textPuntos.dirty=!1},null),0==h.length){BubbleShoot.sound.win.play(),BubbleShoot.entities=BubbleShoot.game.add.group();var w=BubbleShoot.game.add.group();w.enableBody=!0,BubbleShoot.entities.add(w),BubbleShoot.entities.bubbles=w,BubbleShoot.entities.bringToTop(BubbleShoot.entities.bubbles);var I=Math.round(BubbleShoot.UI.maxRows),U=BubbleShoot.UI.maxCols;BubbleShoot.player.board.createGrid(I,U),BubbleShoot.player.board.createBubbles()}}!1,m&&BubbleShoot.CurrenteState.finish(this.enemy),r&&r()}.bind(this),l),this.shooter.reload(),BubbleShoot.player.shooter._nextLoaded.push(BubbleShoot.Bubble.getRandomSprite()),this.shooter.changeAlterBubble(BubbleShoot.player.shooter._nextLoaded[0])}},e.Player=t})(BubbleShoot),function(e){var t={config:{gameWidth:0,bubbleRadius:0,trajectory:{distance:0,duration:600}},circleCollision:function(r,l,g){var u=this.circleCollisionDistance(r.position,l.position),p=r.radius+l.radius;return g&&(p-=r.radius*g+l.radius*g),u<p},circleCollisionDistance:function(r,l){var g=r.x-l.x,u=r.y-l.y;return Math.sqrt(g*g+u*u)},bubbleIntersection:function(r,l){for(var u,g=0;g<l.length;g++)if(u=l[g],!!u)for(var m,p=0;p<u.length;p++)if(m=u[p],!!m){var h=m.position;m.state==BubbleShoot.BUBBLE_STATE_FIRING&&(h=m._endPosition);var w=t.circleCollision({position:r.position,radius:r.radius},{position:h,radius:m.radius},0.1);if(w)return m}return!1}};(function(o){function r(g,u,p,m,h){var I=t.config.bubbleRadius,U=m.side==BubbleShoot.PLAYER_SIDE_TOP,S=t.config.gameWidth-I,B=I,T=m.y+I;U&&(T=m.y+m.height-I);var h=h?++h:1,A=!1,P=!1;if(g.x+=u,g.y-=p,!U&&g.y<=T&&(g.y=T,A='top'),U&&g.y>=T&&(g.y=T,A='top'),g.x<=B&&(g.x=B,A='left'),g.x>=S&&(g.x=S,A='right'),h>2e3)return console.error('Collision.Trajectory.step atingiu limit de iteracoes'),g;if(P=t.bubbleIntersection({position:g,radius:t.config.bubbleRadius},m.grid),A||P){var E=h*t.config.trajectory.distance,G=Math.round(E/1500*1e3);return{position:{x:g.x,y:g.y},duration:G,collision:{dist:E,worldBounds:A,bubble:P}}}return r(g,u,p,m,h)}o.trajectory=function(g,u,p){for(var m=[],h={x:g.x,y:g.y},I=Math.sin(u)*t.config.trajectory.distance,U=Math.cos(u)*t.config.trajectory.distance,m=[],S=0;;){S++;var B=r(h,I,U,p);if(B.collision.worldBounds&&(I*=-1),B.angle=u,m.push(B),S>2e3){console.error('while limit');break}if(!B||B.collision.bubble||'top'==B.collision.worldBounds)break}return m}})(t),e.Collision=t}(BubbleShoot),function(e){var o=9,r=BubbleShoot.Bubble.SIZE,l=BubbleShoot.Bubble.SIZE,g=Math.min(window.innerWidth,window.innerHeight),u=Math.min(window.innerWidth,2*g),g=586,h=g,I=h/r/o,U=BubbleShoot.Bubble.SIZE*I,B={gameApiInst:{},contadorSlides:0,background:'#fff',width:g,height:1024,maxRows:4,maxCols:o,bubble:{scale:I,size:U,radius:U/2},board:{width:h,height:0,rowHeight:U-9,separatorHeight:2},createComojugar:function(){this.modal=BubbleShoot.game.add.sprite(0,0,'modal'),this.modal.alpha=0;var P={font:'90px din_condensedbold',fill:'#fff',align:'center',boundsAlignH:'right',boundsAlignV:'middle',wordWrap:!0,wordWrapWidth:300};this.mecGroup=BubbleShoot.game.add.group(),this.modal.scale.setTo(0.7),this.modal.y=BubbleShoot.game.world.height/2-this.modal.height/2,this.modal.x=BubbleShoot.game.world.width/2-this.modal.width/2;var E=BubbleShoot.game.add.sprite(0,0,'mec2'),O=BubbleShoot.game.add.sprite(0,0,'mec6'),_=BubbleShoot.game.add.sprite(0,0,'mec8'),G=BubbleShoot.game.add.sprite(0,0,'mec10'),L=BubbleShoot.game.add.sprite(0,0,'animMec2'),R=BubbleShoot.game.make.sprite(0,0,'animMec2P');R.visible=!1;var D=BubbleShoot.game.add.sprite(0,0,'animMec3'),C=BubbleShoot.game.make.sprite(0,0,'animMec3P');C.visible=!1;var j=BubbleShoot.game.add.sprite(0,0,'animMec4'),M=BubbleShoot.game.make.sprite(0,0,'animMec4P');M.visible=!1;var H=BubbleShoot.game.add.sprite(0,0,'animMec4'),N=BubbleShoot.game.make.sprite(0,0,'animMec4P');N.visible=!1,this.cerrar=BubbleShoot.game.add.button(0,0,'icocerrar');var J=BubbleShoot.game.world.height/2-E.height/2,W=BubbleShoot.game.world.width/2-E.width/2;E.position.set(W,J),O.position.set(W,J),_.position.set(W,J),G.position.set(W,J),L.position.set(W+60,J+180.5),R.position.set(W+60,J+180.5),E.addChild(L),E.addChild(R),D.position.set(W+60,J+180.5),C.position.set(W+60,J+180.5),O.addChild(D),O.addChild(C),j.position.set(W+60,J+180.5),M.position.set(W+60,J+180.5),_.addChild(j),_.addChild(M),H.position.set(W+60,J+180.5),N.position.set(W+60,J+180.5),G.addChild(H),G.addChild(N),this.cerrar.position.set(BubbleShoot.game.world.width/2-this.cerrar.width/2+210,120),this.mecGroup.add(E),this.mecGroup.add(O),this.mecGroup.add(_),this.mecGroup.add(G),this.mecGroup.forEach(function(z){z.visible=!1}),this.contadorSlides=0,this.mecGroup.children[this.contadorSlides].visible=!0,this.modal.inputEnabled=!0,this.buttonRight=BubbleShoot.game.add.button(0,0,'icoright'),this.buttonRight.y=0.7*BubbleShoot.game.world.height-0.7*this.buttonRight.height,this.buttonRight.x=BubbleShoot.game.world.width/2-this.buttonRight.width/2+200,this.buttonRight.tag='right',this.buttonLeft=BubbleShoot.game.add.button(0,0,'icoleft'),this.buttonLeft.y=0.7*BubbleShoot.game.world.height-0.7*this.buttonLeft.height,this.buttonLeft.x=BubbleShoot.game.world.width/2-this.buttonLeft.width/2-200,this.buttonLeft.tag='left',this.buttonLeft.visible=!1,this.modal.events.onInputDown.add(this.lockInput,this),this.buttonLeft.events.onInputDown.add(this.showSlide,this),this.buttonRight.events.onInputDown.add(this.showSlide,this),this.cerrar.events.onInputDown.add(this.destroyComojugar,this),this.buttonJ=BubbleShoot.game.add.button(0,0,'botonModal'),this.buttonJ.scale.setTo(0.68),this.buttonJ.alpha=0.6,this.buttonJ.y=0.84*BubbleShoot.game.world.height-0.84*this.buttonJ.height,this.buttonJ.x=BubbleShoot.game.world.width/2-this.buttonJ.width/2,P.font='40px din_condensedbold',this.textd=BubbleShoot.game.add.text(0,0,'JUGAR',P),this.textd.y=0.835*BubbleShoot.game.world.height-0.835*this.textd.height,this.textd.x=BubbleShoot.game.world.width/2-this.textd.width/2,this.buttonJ.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.game.state.start('game')},this)},lockInput:function(){console.log('Lock')},showSlide:function(P){if(console.log(),console.log(P.tag),'left'==P.tag?(console.log('lefttttttt'),this.contadorSlides--):this.contadorSlides++,0==this.contadorSlides?(this.buttonLeft.visible=!1,this.contadorSlides=0,this.buttonRight.visible=!0):this.buttonLeft.visible=!0,this.buttonRight.visible=this.contadorSlides!=this.mecGroup.children.length-1,this.mecGroup.forEach(function(O){O.visible=!1}),this.mecGroup.children[this.contadorSlides].visible=!0,this.mecGroup.children[this.contadorSlides].children.length){var E=this.mecGroup.children[this.contadorSlides].children;this.animateMecanica(E)}},animateMecanica:function(P){P[1].visible=!1,P[0].visible=!0;var E=P[0].animations.add('animar');P[0].animations.play('animar',30,!1);var O=this;E.onComplete.add(function(){P[0].visible=!1,P[1].visible=!0;var _=P[1].animations.add('animarp');P[1].animations.play('animarp',30,!1),_.onComplete.add(function(){O.animateMecanica(P)})})},destroyComojugar:function(){this.mecGroup.forEach(function(P){P.kill()}),this.textd.kill(),this.buttonJ.kill(),this.modal.kill(),this.cerrar.kill(),this.buttonRight.kill(),this.buttonLeft.kill(),this.contadorSlides=0,this.clickSound()},destroyMecanica:function(){this.modal.kill(),this.cerrar.kill(),this.mecanicaGroup.forEach(function(P){P.kill()}),this.clickSound()},createMecanica:function(){this.mecanicaGroup=BubbleShoot.game.add.group(),this.modal=BubbleShoot.game.add.image(0,0,'backGame2'),this.modal.inputEnabled=!0,this.modal.events.onInputDown.add(function(){return!1},this),this.modal.y=BubbleShoot.game.world.height/2-this.modal.height/2,this.modal.x=BubbleShoot.game.world.width/2-this.modal.width/2,this.cerrar=BubbleShoot.game.add.button(0,0,'icocerrar'),this.cerrar.position.set(BubbleShoot.game.world.width/2-this.cerrar.width/2+232,86),this.cerrar.events.onInputDown.add(this.destroyMecanica,this);var P={font:'90px din_condensedbold',fill:'#fff',align:'center',boundsAlignH:'right',boundsAlignV:'middle',wordWrap:!0,wordWrapWidth:300,font:'60px din_condensedbold'},E=BubbleShoot.game.add.text(0,0,'T\xC9RMINOS & CONDICIONES',P);if(E.y=80,E.x=BubbleShoot.game.world.width/2-E.width/2,P.font='23px din_condensedbold',P.wordWrapWidth=520,1==BubbleShoot.UI.reg)var O='El juego estar\xE1 disponible exclusivamente para Los Propios, desde el 12 de febrero hasta el 30 de marzo de 2018\nRecibir\xE1s 60 puntos la primera vez que juegues. \nPuedes jugar todas las veces que quieras para mejorar tu posici\xF3n, pero solo se tendr\xE1 en cuenta para el ranking el mejor alcanzado en el menor tiempo.  \nEl juego tiene solamente un nivel y las c\xE1psulas aparecer\xE1n de forma aleatoria.    \nEl objetivo del juego es unir 3 o m\xE1s c\xE1psulas del mismo color o crear combinaciones para obtener puntos (las c\xE1psulas se pueden unir de forma horizontal, vertical o diagonal)\nVe al bot\xF3n \u201C\xBFC\xF3mo Jugar?\u201D en el inicio para saber c\xF3mo sumar puntos en el juego.\nSi en 3 lanzamientos no logras unir c\xE1psulas del mismo color, las c\xE1psulas del tablero bajar\xE1n progresivamente.\nSi las c\xE1psulas del tablero llegan a la l\xEDnea horizontal que est\xE1 en la parte inferior de la pantalla, perder\xE1s la partida.\nSi est\xE1s entre los mejores 10 puntajes de tu regional, el 30 de marzo a las 14:00, recibir\xE1s 1.000 puntos en tu cuenta www.lospropios.net.\nPor ning\xFAn motivo el reconocimiento ser\xE1 entregado en dinero en efectivo.';else var O='El juego estar\xE1 disponible exclusivamente para Los Propios desde el 12 de febrero hasta el 30 de marzo de 2018\nRecibir\xE1s 60 puntos la primera vez que juegues.\nPuedes jugar todas las veces que quieras para mejorar tu posici\xF3n, pero solo se tendr\xE1 en cuenta para el ranking el mejor puntaje alcanzado en el menor tiempo.\nEl juego tiene solamente un nivel y las c\xE1psulas aparecer\xE1n de forma aleatoria.\nEl objetivo del juego es unir 3 o m\xE1s c\xE1psulas del mismo color para obtener puntos (las c\xE1psulas se pueden unir de forma horizontal, vertical o diagonal)\nVe al bot\xF3n \u201C\xBFC\xF3mo Jugar?\u201D en el inicio para saber c\xF3mo sumar puntos en el juego.\nSi en 3 lanzamientos no logras unir c\xE1psulas del mismo color, las c\xE1psulas del tablero bajar\xE1n progresivamente.\nSi las c\xE1psulas del tablero llegan a la linea horizontal que est\xE1 en la parte inferior de la pantalla, perder\xE1s la partida.\nSi est\xE1s entre los mejores 10 puntajes de tu regional el 30 de marzo a las 14:00, recibir\xE1s 1.500 puntos en tu cuenta www.lospropios.net.\nPor ning\xFAn motivo el reconocimiento ser\xE1 entregado en dinero en efectivo.';var _=BubbleShoot.game.add.text(0,0,O,P);_.y=0.8*BubbleShoot.game.world.height-0.8*_.height,_.x=BubbleShoot.game.world.width/2-_.width/2,this.mecanicaGroup.add(this.modal),this.mecanicaGroup.add(E),this.mecanicaGroup.add(_)},clickSound:function(){BubbleShoot.sound.clic.play()},changeBack:function(){document.getElementById('backDeskNorm').style.cssText='z-index:0',document.getElementById('backDeskGame').style.cssText='z-index:1'},changeBack2:function(){document.getElementById('backDeskNorm').style.cssText='z-index:1',document.getElementById('backDeskGame').style.cssText='z-index:0'},reg:3,gameApi:{getUserInformation:function(){B.gameApiInst.getUserInformation();var P=new Promise(function(E,O){B.gameApiInst.onSuccess=function(_){E(_)},B.gameApiInst.onError=function(_){O(_)}});return P},createGameSession:function(){B.gameApiInst.createGameSession();var P=new Promise(function(E,O){B.gameApiInst.onSuccess=function(_){E(_)},B.gameApiInst.onError=function(_){O(_)}});return P},getGameSession:function(P){B.gameApiInst.getGameSession(P);var E=new Promise(function(O,_){B.gameApiInst.onSuccess=function(G){O(G)},B.gameApiInst.onError=function(G){_(G)}});return E},sendPoints:function(P){B.gameApiInst.sendPoints(P);var E=new Promise(function(O,_){B.gameApiInst.onSuccess=function(G){O(G)},B.gameApiInst.onError=function(G){_(G)}});return E}}};if(BubbleShoot.UI=B,'produccion'==BubbleShoot.deploy){BubbleShoot.UI.gameApiInst=new GameAPI;console.log;console.log=function(){},console.log(BubbleShoot.UI.gameApiInst)}e.UI=B}(BubbleShoot),function(e){function t(o){this.player=o,this.service=new BubbleShoot.Background('ai'),this.state='bootstrap';var r={bubbleRadius:BubbleShoot.UI.bubble.radius,gameWidth:BubbleShoot.game.width},l=[this.player.getMetaData(),r];this.service.execute('bootstrap',l,this.tick,this)}t.prototype.stop=function(){return this.state='stop',clearTimeout(this.timer)},t.prototype.tick=function(){clearTimeout(this.timer),'stop'!=this.state&&(this.timer=setTimeout(this.update.bind(this),1500))},t.prototype.update=function(){return'updating'!=this.state&&this.player.shooter.bubble?void(this.state='updating',this.fire(function(){this.updateGrid(function(){'stop'!=this.state&&(this.state='updated'),this.tick()})})):this.tick()},t.prototype.updateGrid=function(o){this.service.execute('updateGrid',[this.player.board.getGridMetaData()],o,this)},t.prototype.fire=function(o){this.service.execute('findBestAgle',[this.player.shooter.bubble.tag],function(g){var m=this.player.shooter.rotation-g.rotation;this.player.shooter.rotation<g.rotation&&(m=g.rotation-this.player.shooter.rotation);var h=Math.round(1e3*m/2e3*1e3);0>=h&&(h=50);var w=BubbleShoot.game.add.tween(this.player.shooter);w.to({rotation:g.rotation},h),w.onComplete.add(function(){this.player.fire(o.bind(this),g.trajectory)}.bind(this)),w.start()},this)},t.prototype.randomMove=function(){var o=33,r=Math.abs(this.player.shooter.angle),r=Math.abs(180),l=Math.max(95,r-o),g=Math.min(265,r+o),u={angle:Utils.getRandomInt(l,g)};u.rotation=Utils.degreesToRadians(u.angle);var p=BubbleShoot.game.add.tween(this.player.shooter);p.to({rotation:u.rotation},1e3),p.onComplete.add(function(){this.randomMove()},this),p.start()},e.AI=t}(BubbleShoot);(function(e){'use strict';var o=function(l){this.game=l};o.prototype={create:function(){this.game.stage.disableVisibilityChange=!0,BubbleShoot.UI.changeBack(),BubbleShoot.CurrenteState=this,BubbleShoot.state='stated',this.background=BubbleShoot.game.add.image(0,0,'backGame'),this.background.inputEnabled=!0,this.boardShoot=BubbleShoot.game.add.image(0,BubbleShoot.game.height-260,'shooterx'),BubbleShoot.spinBtn=BubbleShoot.game.add.button(0,0,'spin'),BubbleShoot.spinBtn.position.set(BubbleShoot.game.world.centerX+20,BubbleShoot.game.height-190),BubbleShoot.spinBtn.scale.setTo(0.5),BubbleShoot.spinBtn.events.onInputDown.add(this.changeBubble,this),this.game.device.touch||(BubbleShoot.spinBtn.events.onInputOver.add(function(){this.boardShoot.loadTexture('shooterxHov')},this),BubbleShoot.spinBtn.events.onInputOut.add(function(){this.boardShoot.loadTexture('shooterx')},this)),this.game.time.advancedTiming=!0,BubbleShoot.fire=!0,BubbleShoot.entities=BubbleShoot.game.add.group();var l=BubbleShoot.game.add.group();l.enableBody=!0,BubbleShoot.entities.add(l),BubbleShoot.entities.bubbles=l,BubbleShoot.isTouch=this.game.device.touch,console.log(BubbleShoot.isTouch),this.createPlayers(function(){this.configureCollision(),this.createTablero(),this.attachEvents()}),BubbleShoot.entities.bringToTop(BubbleShoot.entities.bubbles),this.timerGame=this.game.time.create(!1),this.timerGame.loop(1,this.cronometro,this),this.timerGame.loop(1e3,this.updateTextTime,this),this.timerGame.start(),BubbleShoot.sessionTime='00:00',this.horas=0,this.centesimas=0,this.segundos=0,this.minutos=0,this.totalSegundos=0;BubbleShoot.timeText=this.game.add.text(0,0,'00:00',{font:'38px din_condensedbold',fill:'#fff',align:'left',boundsAlignH:'right',boundsAlignV:'middle',wordWrap:!0,wordWrapWidth:300}),BubbleShoot.timeText.setTextBounds(70,20,135,53),BubbleShoot.sound.shoot=this.game.add.sound('launch'),BubbleShoot.sound.explosion=this.game.add.sound('explosion'),BubbleShoot.sound.fail=this.game.add.sound('fail'),BubbleShoot.sound.win=this.game.add.sound('win'),BubbleShoot.sound.goodjob=this.game.add.sound('goodjob'),BubbleShoot.animations={},BubbleShoot.animations.mentol=BubbleShoot.game.add.sprite(-250,-250,'mentol'),BubbleShoot.animations.mentol.visible=!1,BubbleShoot.animations.mentol.y=this.world.height/2-BubbleShoot.animations.mentol.height/2,BubbleShoot.animations.mentol.x=this.world.width/2-BubbleShoot.animations.mentol.width/2,BubbleShoot.animations.purpleX2=BubbleShoot.game.add.sprite(-250,-250,'purplex2'),BubbleShoot.animations.purpleX2.visible=!1,BubbleShoot.animations.purpleX2.y=this.world.height/2-BubbleShoot.animations.purpleX2.height/2,BubbleShoot.animations.purpleX2.x=this.world.width/2-BubbleShoot.animations.purpleX2.width/2,BubbleShoot.animations.sabor=BubbleShoot.game.add.sprite(-250,-250,'sabor'),BubbleShoot.animations.sabor.visible=!1,BubbleShoot.animations.sabor.y=this.world.height/2-BubbleShoot.animations.sabor.height/2,BubbleShoot.animations.sabor.x=this.world.width/2-BubbleShoot.animations.sabor.width/2},updateTextTime:function(){setTimeout(function(){BubbleShoot.timeText.text=BubbleShoot.sessionTime,BubbleShoot.timeText.updateText(),BubbleShoot.timeText.dirty=!1},null)},cronometro:function(){59>this.centesimas&&this.centesimas++,59==this.centesimas&&(this.centesimas=-1),0==this.centesimas&&(this.segundos++,this.totalSegundos++,BubbleShoot.sessionTime=10>this.segundos&&10>this.minutos?'0'+this.minutos+':0'+this.segundos:10>this.segundos?this.minutos+':0'+this.segundos:10>this.minutos?'0'+this.minutos+':'+this.segundos:this.minutos+':'+this.segundos),59==this.segundos&&(this.segundos=-1),0==this.centesimas&&0==this.segundos&&this.minutos++,59==this.minutos&&(this.minutos=-1),0==this.centesimas&&0==this.segundos&&0==this.minutos&&this.horas++,BubbleShoot.totalSegundos=1e3*parseFloat(this.totalSegundos+'.'+this.centesimas)},createPlayers:function(l){if(BubbleShoot.mode==BubbleShoot.MODES.SINGLEPLAYER){BubbleShoot.player=new BubbleShoot.Player('You',BubbleShoot.PLAYER_SIDE_BOTTOM);var g=Math.round(BubbleShoot.UI.maxRows),u=BubbleShoot.UI.maxCols;return BubbleShoot.player.board.createGrid(g,u),BubbleShoot.player.board.createBubbles(),BubbleShoot.player.shooter.showTrajectory(!1),BubbleShoot.player.shooter.reload(!0),BubbleShoot.player.enemy=BubbleShoot.enemy,BubbleShoot.player.shooter.createAlterBubble(),l.call(this)}},changeBubble:function(){BubbleShoot.player.shooter.changeBubble()},createTablero:function(){BubbleShoot.tablero=this.game.add.button(0,0,'tablero');BubbleShoot.textPuntos=this.game.add.text(0,0,'0',{font:'38px din_condensedbold',fill:'#fff',align:'left',boundsAlignH:'right',boundsAlignV:'middle',wordWrap:!0,wordWrapWidth:300}),BubbleShoot.textPuntos.setTextBounds(345,20,135,53),BubbleShoot.tablero.onInputDown.add(function(){this.createPause(),BubbleShoot.tablero.loadTexture('tablero-press')},this),BubbleShoot.player.board.createLifes()},createPause:function(){BubbleShoot.UI.clickSound(),BubbleShoot.state='pause',this.timerGame.paused=!0,this.detachEvents(),this.createModalLayer()},configureCollision:function(){var l=BubbleShoot.Collision.config;l.bubbleRadius=BubbleShoot.UI.bubble.radius,l.trajectory.distance=BubbleShoot.UI.bubble.radius/5,l.trajectory.duration=600,l.gameWidth=BubbleShoot.game.width},attachEvents:function(){BubbleShoot.tablero.inputEnabled=!0,this.game.input.addMoveCallback(this.inputMove,this),this.background.events.onInputDown.add(this.inputDown,this),this.background.events.onInputUp.add(this.inputUp,this),this.game.canvas.style.cursor='crosshair'},detachEvents:function(){BubbleShoot.tablero.inputEnabled=!1,this.game.input.deleteMoveCallback(this.inputMove,this),this.background.events.onInputUp.remove(this.inputUp,this),this.game.canvas.style.cursor='default'},update:function(){12<BubbleShoot.player.board.grid.length;var l=this;12<BubbleShoot.player.board.grid.length&&BubbleShoot.player.board.grid[12].map(function(g){g!=void 0&&l.finish()}),BubbleShoot.fire?BubbleShoot.player.shooter.showTrajectory(!1):BubbleShoot.player.shooter.showTrajectory(!0)},render:function(){BubbleShoot.game.debug.geom(BubbleShoot.pause,'#0fffff')},inputDown:function(){BubbleShoot.fire=!1},inputUp:function(){BubbleShoot.fire=!0,'finished'!=BubbleShoot.state&&'pause'!=BubbleShoot.state&&BubbleShoot.player.fire()},inputMove:function(){var m=this.game.physics.arcade.angleToPointer(BubbleShoot.player.shooter);m+=1.57079633,BubbleShoot.player.shooter.setRotation(m)},finish:function(){return'finished'!=BubbleShoot.state&&void(BubbleShoot.sound.fail.play(),BubbleShoot.state='finished',this.timerGame.stop(),this.detachEvents(),this.createModalLayer(),BubbleShoot.player.board.savePoints(BubbleShoot.totalSegundos))},createModalLayer:function(){this.detachEvents(),BubbleShoot.spinBtn.inputEnabled=!1;var l=this.game.add.group(),g=this.add.sprite(0,0,'modal');g.scale.setTo(0.7),this.background.inputEnabled=!1,g.y=this.world.height/2-g.height/2,g.x=this.world.width/2-g.width/2;var u={font:'90px din_condensedbold',fill:'#fff',align:'center',boundsAlignH:'right',boundsAlignV:'middle',wordWrap:!0,wordWrapWidth:300},p=this.game.add.button(0,0,'icoinicio');p.scale.setTo(1.2),p.alpha=0.6,p.y=0.7*this.world.height-0.7*p.height,p.x=this.world.width/2-p.width/2-200;var m=this.game.add.button(0,0,'icoranking');m.scale.setTo(1.2),m.alpha=0.6,m.y=0.7*this.world.height-0.7*m.height,m.x=this.world.width/2-m.width/2-70;var h=this.game.add.button(0,0,'icomecanica');h.scale.setTo(1.2),h.alpha=0.6,h.y=0.704*this.world.height-0.704*h.height,h.x=this.world.width/2-h.width/2+70;var w=this.game.add.button(0,0,'icosonido');if(w.scale.setTo(1.2),w.alpha=0.6,w.y=0.7*this.world.height-0.7*w.height,w.x=this.world.width/2-w.width/2+200,'pause'==BubbleShoot.state){var I=this.game.add.text(0,0,'PAUSA',u);I.y=250,I.x=this.world.width/2-I.width/2,u.font='35px din_condensedbold';var U=this.game.add.image(0,0,'icopause');U.y=420,U.x=this.world.width/2-U.width/2;var S=this.game.add.button(0,0,'botonModal');S.scale.setTo(0.7),S.alpha=0.2,S.y=0.84*this.world.height-0.84*S.height,S.x=this.world.width/2-S.width/2,u.font='40px din_condensedbold',this.text5=this.game.add.text(0,0,'CONTINUAR JUGANDO',u),this.text5.y=0.835*this.world.height-0.835*this.text5.height,this.text5.x=this.world.width/2-this.text5.width/2,l.add(g),l.add(I),l.add(U),l.add(S),l.add(this.text5),S.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.tablero.loadTexture('tablero'),l.forEach(function(P){BubbleShoot.game.add.tween(P).to({alpha:0},300,'Linear',!0,0)}),BubbleShoot.state='running',this.timerGame.paused=!1,BubbleShoot.spinBtn.inputEnabled=!0,S.destroy(),m.destroy(),p.destroy(),h.destroy(),w.destroy(),this.attachEvents(),this.background.inputEnabled=!0},this)}else{u.font='45px din_condensedbold';var I=this.game.add.text(0,0,'OUCH',u);I.y=160,I.x=this.world.width/2-I.width/2,u.font='35px din_condensedbold',u.wordWrapWidth=500;var B=this.game.add.text(0,0,'Vuelve a empezar y mejora tu puntaje',u);B.y=this.world.height/4-B.height/4,B.x=this.world.width/2-B.width/2,u.font='60px din_condensedbold';var T=this.game.add.text(0,0,BubbleShoot.player.board.returnPoints(),u);T.y=0.4*this.world.height-0.4*T.height,T.x=this.world.width/2-T.width/2,u.font='26px din_condensedbold';var A=this.game.add.text(0,0,'PUNTOS',u);A.y=0.45*this.world.height-0.45*A.height,A.x=this.world.width/2-A.width/2;var S=this.game.add.button(0,0,'botonModal');S.scale.setTo(0.68),S.alpha=0.6,S.y=0.84*this.world.height-0.84*S.height,S.x=this.world.width/2-S.width/2,u.font='45px din_condensedbold',this.text5=this.game.add.text(0,0,'VOLVER A JUGAR',u),this.text5.y=0.84*this.world.height-0.84*this.text5.height,this.text5.x=this.world.width/2-this.text5.width/2,l.add(g),l.add(I),l.add(B),l.add(T),l.add(A),l.add(S),l.add(this.text5),S.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.player.board.savePoints(BubbleShoot.totalSegundos),BubbleShoot.tablero.loadTexture('tablero-press'),this.game.state.start('game')},this)}this.text5.alpha=0.6,S.events.onInputOver.add(this.hoverBtnx,this),S.events.onInputOut.add(this.unHoverBtnx,this),p.events.onInputOver.add(this.hoverBtn,this),p.events.onInputOut.add(this.unHoverBtn,this),m.events.onInputOver.add(this.hoverBtn,this),m.events.onInputOut.add(this.unHoverBtn,this),h.events.onInputOver.add(this.hoverBtn,this),h.events.onInputOut.add(this.unHoverBtn,this),w.events.onInputOver.add(this.hoverBtn,this),w.events.onInputOut.add(this.unHoverBtn,this),m.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.player.board.savePoints(BubbleShoot.totalSegundos),this.state.start('ranking')},this),p.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.player.board.savePoints(BubbleShoot.totalSegundos),this.game.state.start('menu')},this),h.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.UI.createMecanica()},this),w.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.game.sound.mute=!BubbleShoot.game.sound.mute,BubbleShoot.game.sound.mute?w.loadTexture('icosonidoPause'):w.loadTexture('icosonido')},this)},hoverBtn:function(l){BubbleShoot.game.add.tween(l).to({alpha:0.8},300,'Linear',!0,0)},unHoverBtn:function(l){BubbleShoot.game.add.tween(l).to({alpha:0.6},300,'Linear',!0,0)},hoverBtnx:function(l){var g=BubbleShoot.game.add.tween(this.text5).to({alpha:0.8},300,'Linear',!0,0),u=BubbleShoot.game.add.tween(l).to({alpha:0.8},300,'Linear',!0,0)},unHoverBtnx:function(l){var g=BubbleShoot.game.add.tween(this.text5).to({alpha:0.6},300,'Linear',!0,0),u=BubbleShoot.game.add.tween(l).to({alpha:0.6},300,'Linear',!0,0)}},e.Game=o})(this,BubbleShoot),function(e){var t=function(r){this.game=r};t.prototype={create:function(){BubbleShoot.UI.changeBack2(),BubbleShoot.mode=BubbleShoot.MODES.SINGLEPLAYER,this.background=BubbleShoot.game.add.image(0,0,'intro'),this.background.width=this.world.width,this.background.height=this.world.height;var r={font:'45px din_alternatebold',fill:'#fff',align:'center',boundsAlignH:'right',boundsAlignV:'middle'},l=this.add.button(0,0,'botonModal');l.scale.setTo(0.85),l.alpha=0.6,l.y=0.54*this.world.height-0.54*l.height,l.x=this.world.width/2-l.width/2,r.font='40px din_condensedbold',this.text5=this.add.text(0,0,'JUGAR',r),this.text5.y=0.54*this.world.height-0.54*this.text5.height,this.text5.x=this.world.width/2-this.text5.width/2;var g=this.add.button(0,0,'botonModal');g.scale.setTo(0.85),g.alpha=0.66,g.y=0.66*this.world.height-0.66*g.height,g.x=this.world.width/2-g.width/2,r.font='40px din_condensedbold',this.text8=this.add.text(0,0,'\xBFC\xD3MO JUGAR?',r),this.text8.y=0.66*this.world.height-0.66*this.text8.height,this.text8.x=this.world.width/2-this.text8.width/2;var u=this.add.button(0,0,'icomecanica');u.scale.setTo(1.1),u.alpha=0.6,u.y=0.805*this.world.height-0.805*u.height,u.x=this.world.width/2-u.width/2-138;var p=this.add.button(0,0,'icoranking');p.scale.setTo(1.1),p.alpha=0.6,p.y=0.8*this.world.height-0.8*p.height,p.x=this.world.width/2-p.width/2+140,l.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),this.state.start('game')},this),p.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),this.state.start('ranking')},this),g.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.UI.createComojugar()},this),u.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.UI.createMecanica()},this),l.events.onInputOver.add(this.hoverBtnx,this),l.events.onInputOut.add(this.unHoverBtnx,this),u.events.onInputOver.add(this.hoverBtn,this),u.events.onInputOut.add(this.unHoverBtn,this),p.events.onInputOver.add(this.hoverBtn,this),p.events.onInputOut.add(this.unHoverBtn,this),g.events.onInputOver.add(this.hoverBtn,this),g.events.onInputOut.add(this.unHoverBtn,this)},hoverBtn:function(r){BubbleShoot.game.add.tween(r).to({alpha:0.8},300,'Linear',!0,0)},unHoverBtn:function(r){BubbleShoot.game.add.tween(r).to({alpha:0.6},300,'Linear',!0,0)},hoverBtnx:function(r){BubbleShoot.game.add.tween(r).to({alpha:0.8},300,'Linear',!0,0)},unHoverBtnx:function(r){BubbleShoot.game.add.tween(r).to({alpha:0.6},300,'Linear',!0,0)},startFullScreen:function(){this.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.startFullScreen(!1)}},e.Menu=t}(this),function(e){var t=function(r){this.game=r};t.prototype={preload:function(){this.game.stage.disableVisibilityChange=!0;var r=this.add.sprite(0,0,'loading');r.scale.setTo(0.3),r.y=this.world.height/2-r.height/2,r.x=this.world.width/2-r.width/2;r.animations.add('start');r.animations.play('start',30,!0),this.load.atlasJSONHash('sprites',assetsPath+'/img/sprites3.png',assetsPath+'/json/sprites.json'),this.load.image('tablero',assetsPath+'/img/tablero.png'),this.load.image('tablero-press',assetsPath+'/img/tablero-press.png'),this.game.device.touch?this.load.image('shooterx',assetsPath+'/img/shooter.png'):(this.load.image('shooterxHov',assetsPath+'/img/shooter.png'),this.load.image('shooterx',assetsPath+'/img/shooterMovil.png')),this.load.image('spin',assetsPath+'/img/spin.png'),this.load.image('backGame2',assetsPath+'/img/back2.png'),this.load.image('backGame',assetsPath+'/img/back.png'),this.load.image('plop40',assetsPath+'/img/plop40.png'),this.load.image('plop20',assetsPath+'/img/plop20.png'),this.load.image('plop10',assetsPath+'/img/plop10.png'),this.load.image('modal',assetsPath+'/img/modal.png'),this.load.image('intro',assetsPath+'/img/intro.png'),this.load.image('barra',assetsPath+'/img/barra.png'),this.load.image('icocerrar',assetsPath+'/img/icocerrar.png'),this.load.image('icoinicio',assetsPath+'/img/icoinicio.png'),this.load.image('icomecanica',assetsPath+'/img/icomecanica.png'),this.load.image('icoranking',assetsPath+'/img/icoranking.png'),this.load.image('icoterminos',assetsPath+'/img/icoterminos.png'),this.load.image('icosonido',assetsPath+'/img/icosonido.png'),this.load.image('icosonidoPause',assetsPath+'/img/icosonido-pausa.png'),this.load.image('icoright',assetsPath+'/img/right.png'),this.load.image('icoleft',assetsPath+'/img/left.png'),this.load.image('mec1',assetsPath+'/img/mecanica/1-01.png'),this.load.image('mec2',assetsPath+'/img/mecanica/2-01.png'),this.load.image('mec6',assetsPath+'/img/mecanica/6-01.png'),this.load.image('mec8',assetsPath+'/img/mecanica/8-01.png'),this.load.image('mec10',assetsPath+'/img/mecanica/10-01.png'),this.load.image('bolaon',assetsPath+'/img/bolaon.png'),this.load.image('bolaoff',assetsPath+'/img/bolaoff.png'),this.load.image('boton',assetsPath+'/img/boton.png'),this.load.image('botonModal',assetsPath+'/img/boton-modal.png'),this.load.image('icoterminos',assetsPath+'/img/icoterminos.png'),this.load.image('icoterminos',assetsPath+'/img/icoterminos.png'),this.load.image('icopause',assetsPath+'/img/pause.png'),this.load.atlasJSONHash('chispa-orange',assetsPath+'/img/chispas/gris/gris.png',assetsPath+'/img/chispas/gris/gris.json'),this.load.atlasJSONHash('chispa-yellow',assetsPath+'/img/chispas/amarillo/sprites.png',assetsPath+'/img/chispas/amarillo/sprites.json'),this.load.atlasJSONHash('chispa-blue',assetsPath+'/img/chispas/azul/sprites.png',assetsPath+'/img/chispas/azul/sprites.json'),this.load.atlasJSONHash('chispa-magenta',assetsPath+'/img/chispas/morada/sprites.png',assetsPath+'/img/chispas/morada/sprites.json'),this.load.atlasJSONHash('chispa-red',assetsPath+'/img/chispas/roja/sprites.png',assetsPath+'/img/chispas/roja/sprites.json'),this.load.atlasJSONHash('chispa-green',assetsPath+'/img/chispas/verde/sprites.png',assetsPath+'/img/chispas/verde/sprites.json'),this.load.atlasJSONHash('mentol',assetsPath+'/img/textos/mentol.png',assetsPath+'/img/textos/mentol.json'),this.load.atlasJSONHash('purplex2',assetsPath+'/img/textos/purplex2.png',assetsPath+'/img/textos/purplex2.json'),this.load.atlasJSONHash('sabor',assetsPath+'/img/textos/sabor.png',assetsPath+'/img/textos/sabor.json'),this.load.atlasJSONHash('animMec2',assetsPath+'/img/mecanica/mecanica1.png',assetsPath+'/img/mecanica/mecanica1.json'),this.load.atlasJSONHash('animMec2P',assetsPath+'/img/mecanica/mecanica1puntos.png',assetsPath+'/img/mecanica/mecanica1puntos.json'),this.load.atlasJSONHash('animMec3',assetsPath+'/img/mecanica/mecanica2.png',assetsPath+'/img/mecanica/mecanica2.json'),this.load.atlasJSONHash('animMec3P',assetsPath+'/img/mecanica/mecanica2puntos.png',assetsPath+'/img/mecanica/mecanica2puntos.json'),this.load.atlasJSONHash('animMec4',assetsPath+'/img/mecanica/mecanica3.png',assetsPath+'/img/mecanica/mecanica3.json'),this.load.atlasJSONHash('animMec4P',assetsPath+'/img/mecanica/mecanica3puntos.png',assetsPath+'/img/mecanica/mecanica3puntos.json'),this.load.audio('explosion',[assetsPath+'/sounds/explosion.ogg',assetsPath+'/sounds/explosion.mp3']),this.load.audio('launch',[assetsPath+'/sounds/launch.ogg',assetsPath+'/sounds/launch.mp3']),this.load.audio('win',[assetsPath+'/sounds/win.ogg',assetsPath+'/sounds/win.mp3']),this.load.audio('fail',[assetsPath+'/sounds/fail.ogg',assetsPath+'/sounds/fail.mp3']),this.load.audio('goodjob',[assetsPath+'/sounds/goodjob.mp3']),this.load.audio('clic',[assetsPath+'/sounds/clic.mp3'])},create:function(){BubbleShoot.sound.clic=this.game.add.sound('clic'),this.state.start('menu')}},e.Preloader=t}(this),function(e){var t=function(r){this.game=r};t.prototype={preload:function(){this.load.crossOrigin='anonymous',this.load.spritesheet('loading',assetsPath+'/img/loading.png',512,256,13),this.load.audio('main',[assetsPath+'/sounds/main.mp3',assetsPath+'/sounds/main.ogg'])},create:function(){BubbleShoot.sound={},BubbleShoot.sound.main=this.game.add.sound('main'),BubbleShoot.sound.main.volume=0.05,BubbleShoot.sound.main.loop=!0,BubbleShoot.sound.main.play(),this.input.maxPointers=1,this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,'produccion'==BubbleShoot.deploy&&this.getUser(),this.state.start('preloader')},getUser:function(){var r=this;BubbleShoot.UI.gameApi.getUserInformation().then(function(l){console.log(l),BubbleShoot.UI.infoUsuarioAPI=l;var g=new XMLHttpRequest;if(1==BubbleShoot.UI.reg)var u='https://ddbdev.co/chesterbubbleAPI/public/userIdPropios/'+BubbleShoot.UI.infoUsuarioAPI.respondentGUID;else var u='https://ddbdev.co/chesterbubbleAPI2/public/userIdPropios/'+BubbleShoot.UI.infoUsuarioAPI.respondentGUID;g.onreadystatechange=function(){if(4==this.readyState){var m=JSON.parse(this.responseText);r.createRank(m)}},g.open('GET',u,!0);try{g.send()}catch(m){console.log(m)}}).catch(function(l){console.log(l)})},createRank:function(r){if(0===r.length){var l='name='+BubbleShoot.UI.infoUsuarioAPI.firstName+' '+BubbleShoot.UI.infoUsuarioAPI.lastName+'&id_los_propios='+BubbleShoot.UI.infoUsuarioAPI.respondentGUID+'',g=new XMLHttpRequest;if(1==BubbleShoot.UI.reg)var u='https://ddbdev.co/chesterbubbleAPI/public/ranking';else var u='https://ddbdev.co/chesterbubbleAPI2/public/ranking';g.open('POST',u,!0),g.setRequestHeader('Content-type','application/x-www-form-urlencoded'),g.onreadystatechange=function(){if(4==g.readyState&&200==g.status){console.log(g.responseText);var p=JSON.parse(g.responseText);BubbleShoot.UI.infoUsuarioAPI.pointsOld=0,BubbleShoot.UI.infoUsuarioAPI.idAPI=''===p.data[0].id?0:p.data[0].id}},g.send(l),BubbleShoot.UI.gameApi.createGameSession().then(function(p){BubbleShoot.UI.gameSession=p.gameSessionID;var m={gameSessionID:BubbleShoot.UI.gameSession,points:60};BubbleShoot.UI.gameApi.sendPoints(m).then(function(h){console.log(h)}).catch(function(h){console.log(h)})}).catch(function(p){console.error(p)})}else BubbleShoot.UI.infoUsuarioAPI.pointsOld=''===r[0].points?0:r[0].points,BubbleShoot.UI.infoUsuarioAPI.idAPI=''===r[0].id?0:r[0].id,BubbleShoot.UI.infoUsuarioAPI.time=''===r[0].time?0:r[0].time,BubbleShoot.UI.infoUsuarioAPI.name=''===r[0].name?0:r[0].name,BubbleShoot.UI.infoUsuarioAPI.position=''===r[0].position?0:r[0].position}},e.Boot=t}(this),function(e){var t=function(r){this.game=r};t.prototype={create:function(){this.background=BubbleShoot.game.add.image(0,0,'backGame2'),BubbleShoot.UI.changeBack2(),'produccion'==BubbleShoot.deploy&&this.getUser();var r={font:'90px din_condensedbold',fill:'#fff',align:'center'};r.tabs=[120,230,100,80],r.font='30px din_condensedbold',this.headers=['POSICI\xD3N','NOMBRES','PUNTOS','TIEMPO'],this.rankHeaders=this.game.add.text(0,0,'',r),this.rankHeaders.parseList(this.headers),this.rankHeaders.x=BubbleShoot.game.world.width/2-this.rankHeaders.width/2,this.rankHeaders.y=BubbleShoot.game.world.height/2-this.rankHeaders.height/2-270;var r={font:'90px din_condensedbold',fill:'#fff',align:'center',boundsAlignH:'right',boundsAlignV:'middle',wordWrap:!0,wordWrapWidth:300};this.loading=this.game.add.sprite(0,0,'loading'),this.loading.scale.setTo(0.3),this.loading.y=this.game.world.height/2-this.loading.height/2,this.loading.x=this.game.world.width/2-this.loading.width/2;this.loading.animations.add('start');this.loading.animations.play('start',30,!0),r.font='60px din_condensedbold';var g=BubbleShoot.game.add.text(0,0,'RANKING',r);g.y=80,g.x=BubbleShoot.game.world.width/2-g.width/2;var u=new XMLHttpRequest;if(1==BubbleShoot.UI.reg)var p='https://ddbdev.co/chesterbubbleAPI/public/positions';else var p='https://ddbdev.co/chesterbubbleAPI2/public/positions';var m=this;u.onreadystatechange=function(){if(4==this.readyState){var h=JSON.parse(this.responseText);m.updateUsuarios(h)}},u.open('GET',p,!0);try{u.send()}catch(h){console.log(h)}},updateCurrent:function(r){console.log(r);var g={font:'90px din_condensedbold',fill:'#fff',align:'center'};g.tabs=[120,230,100,80],g.font='30px din_condensedbold';var u=this.game.add.image(0,0,'barra');u.scale.setTo(0.75),u.x=BubbleShoot.game.world.width/2-u.width/2,u.y=this.rankHeaders.y+50,u.alpha=0.3,'produccion'!=BubbleShoot.deploy&&(r={},r.pointsOld=8.5e7,r.name='Cristian Andres Arrieta',r.time='00:00:20',r.position='1');var p=[r.position,r.name,r.pointsOld,r.time],m=this.game.add.text(0,0,'',g);m.parseList(p),m.x=BubbleShoot.game.world.width/2-this.rankHeaders.width/2,m.y=this.rankHeaders.y+50},updateUsuarios:function(r){this.loading.animations.stop('start'),this.loading.visible=!1;var l=[],g={font:'90px din_condensedbold',fill:'#fff',align:'center'};r[0].map(function(I){25<I.name.length&&(I.name=I.name.substring(0,20)+'...'),I.name=I.name.toLowerCase(),I.name=I.name.replace(/\b[a-z]/g,function(S){return S.toUpperCase()});var U=[I.position+'',I.name,I.points+'',I.time];l.push(U)}),g.tabs=[120,230,100,80],g.font='30px din_condensedbold';var u=this.game.add.text(0,0,'',g);u.parseList(l),u.x=BubbleShoot.game.world.width/2-this.rankHeaders.width/2,u.y=BubbleShoot.game.world.height/2-u.height/2+10;var p=this.game.add.button(0,0,'icoinicio');p.scale.setTo(1.2),p.alpha=0.6,p.y=0.8*this.world.height-0.8*p.height,p.x=this.world.width/2-p.width/2-200;var m=this.game.add.button(0,0,'icomecanica');m.scale.setTo(1.2),m.alpha=0.6,m.y=0.805*this.world.height-0.805*m.height,m.x=this.world.width/2-m.width/2+70;var h=this.game.add.button(0,0,'icosonido');h.scale.setTo(1.2),h.alpha=0.6,h.y=0.8*this.world.height-0.8*h.height,h.x=this.world.width/2-h.width/2+200;var w=this.add.button(0,0,'botonModal');w.scale.setTo(0.75),w.alpha=0.6,w.y=0.92*BubbleShoot.game.world.height-0.92*w.height,w.x=BubbleShoot.game.world.width/2-w.width/2,g.font='40px din_condensedbold',this.text5=BubbleShoot.game.add.text(0,0,'JUGAR',g),this.text5.y=0.91*BubbleShoot.game.world.height-0.91*this.text5.height,this.text5.x=BubbleShoot.game.world.width/2-this.text5.width/2,w.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),this.state.start('game')},this),p.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),this.game.state.start('menu')},this),m.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.UI.createMecanica()},this),h.events.onInputDown.add(function(){BubbleShoot.UI.clickSound(),BubbleShoot.game.sound.mute=!BubbleShoot.game.sound.mute},this)},getUser:function(){var r=this;BubbleShoot.UI.gameApi.getUserInformation().then(function(l){console.log(l),BubbleShoot.UI.infoUsuarioAPI=l;var g=new XMLHttpRequest;if(1==BubbleShoot.UI.reg)var u='https://ddbdev.co/chesterbubbleAPI/public/userIdPropios/'+BubbleShoot.UI.infoUsuarioAPI.respondentGUID;else var u='https://ddbdev.co/chesterbubbleAPI2/public/userIdPropios/'+BubbleShoot.UI.infoUsuarioAPI.respondentGUID;g.onreadystatechange=function(){if(4==this.readyState){var m=JSON.parse(this.responseText);r.createRank(m)}},g.open('GET',u,!0);try{g.send()}catch(m){console.log(m)}}).catch(function(l){console.log(l)})},createRank:function(r){if(0===r.length){var l='name='+BubbleShoot.UI.infoUsuarioAPI.firstName+' '+BubbleShoot.UI.infoUsuarioAPI.lastName+'&id_los_propios='+BubbleShoot.UI.infoUsuarioAPI.respondentGUID+'',g=new XMLHttpRequest;if(1==BubbleShoot.UI.reg)var u='https://ddbdev.co/chesterbubbleAPI/public/ranking';else var u='https://ddbdev.co/chesterbubbleAPI2/public/ranking';g.open('POST',u,!0),g.setRequestHeader('Content-type','application/x-www-form-urlencoded'),g.onreadystatechange=function(){if(4==g.readyState&&200==g.status){console.log(g.responseText);var p=JSON.parse(g.responseText);BubbleShoot.UI.infoUsuarioAPI.pointsOld=0,BubbleShoot.UI.infoUsuarioAPI.idAPI=''===p.data[0].id?0:p.data[0].id,this.updateCurrent(BubbleShoot.UI.infoUsuarioAPI)}},g.send(l),BubbleShoot.UI.gameApi.createGameSession().then(function(p){BubbleShoot.UI.gameSession=p.gameSessionID;var m={gameSessionID:BubbleShoot.UI.gameSession,points:60};BubbleShoot.UI.gameApi.sendPoints(m).then(function(h){console.log(h)}).catch(function(h){console.log(h)})}).catch(function(p){console.error(p)})}else BubbleShoot.UI.infoUsuarioAPI.pointsOld=''===r[0].points?0:r[0].points,BubbleShoot.UI.infoUsuarioAPI.idAPI=''===r[0].id?0:r[0].id,BubbleShoot.UI.infoUsuarioAPI.time=''===r[0].time?0:r[0].time,BubbleShoot.UI.infoUsuarioAPI.name=''===r[0].name?0:r[0].name,BubbleShoot.UI.infoUsuarioAPI.position=''===r[0].position?0:r[0].position,this.updateCurrent(BubbleShoot.UI.infoUsuarioAPI)}},e.Ranking=t}(this),function(){var t=new Phaser.Game(BubbleShoot.UI.width,BubbleShoot.UI.height,Phaser.AUTO,'game',null,!0);t.state.add('boot',Boot),t.state.add('ranking',Ranking),t.state.add('preloader',Preloader),t.state.add('menu',Menu),t.state.add('game',Game),t.state.start('boot'),BubbleShoot.game=t}(this);